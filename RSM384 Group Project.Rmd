---
title: "RSM 384 Group Project - NBA Defense and Size"
author: AliReza Rezvan, Melody Ashgriz, Jacob Wright, Jeffrey Chu, Tony Wang
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message=FALSE, warning=FALSE)
```

```{r, include = FALSE}
install.packages("tidyverse")
install.packages("RCurl")
install.packages("corrplot")
install.packages("dplyr")
```

```{r, include=FALSE}
library(tidyverse)
library(RCurl)
library(corrplot)
library(dplyr)
library(stats) #for LOESS
library(nnet) #for Multinomial logit
```

## Merging NBA Draft Combine Data and 1996-2024 Advanced Defence Statistics

**NBA Combine (2000-2024)**

```{r}
url <- getURL("https://raw.githubusercontent.com/jeffreychu48/RSM384/refs/heads/main/NBA_draft_combine.csv")
nba.combine <- read.csv(text = url)
nba.combine <- separate(nba.combine, col = PLAYER, into = c("Last Name", "First Name"), sep = ", ")
nba.combine$Player <- paste(nba.combine$`First Name`, nba.combine$`Last Name`, sep = " ")
nba.combine <- nba.combine %>%
  mutate(WGT = as.numeric(WGT))
nba.combine <- nba.combine %>% select (Player, HGT, WGT, BAR, STNDRCH, PAN, LPVERT, SPRINT, LANE)
colnames(nba.combine)[1] = "PLAYER"
```

**1996-2024 NBA Individual Player Advanced Defensive Stats**

```{r}
url <- getURL("https://raw.githubusercontent.com/jeffreychu48/RSM384/refs/heads/main/1996-2024%20NBA%20Player%20Advanced%20Defensive%20Stats.csv")
nba.9624.player.adv.def <- read.csv(text = url)
```

*Creating a Statistical Minimum (Total Minutes \> 1500) and removing Outliers*

```{r}
nba.9624.player.adv.def <- nba.9624.player.adv.def %>%
  mutate(GP = as.numeric(GP), MIN = as.numeric(MIN), DEFRTG = as.numeric(DEFRTG)) %>%
  mutate(TOTALMIN = GP*MIN, TOTALMIN = as.numeric (TOTALMIN)) %>% 
  filter(TOTALMIN > 1500, YEAR < "2024", !PLAYER == "Aaron McKie", !PLAYER == "A.C. Green")
```

**Merging the Two Datasets**

```{r}
nba.9624.merged <- nba.9624.player.adv.def %>% merge(nba.combine, by = "PLAYER", all = FALSE)

#removing N/A variables from data
nba.9624.merged <- na.omit(nba.9624.merged)   
```

## GLM Model

```{r}
#top and bottom 10% of defenders 
top_10_def <- quantile(nba.9624.merged$DEFRTG, 0.9,)
bottom_10_def <- quantile(nba.9624.merged$DEFRTG, 0.1,)

## creating new variables to the dataset 
nba.9624.merged <- nba.9624.merged %>%
          mutate(DEFNDR = ifelse(DEFRTG>mean(DEFRTG), 1, 0), ELITE = DEFRTG>=top_10_def, TERRIBLE = DEFRTG<=bottom_10_def)

#logistic regression
fit.1 <- glm(DEFNDR ~ HGT + WGT + BAR + PAN + LPVERT + SPRINT + ELITE + TERRIBLE, data = nba.9624.merged, family = "binomial")    

summary(fit.1)
```









## Merging NBA Draft Combine Data and 2023-2024 Advanced Defence Statistics

**2023-2024 NBA Individual Player Advanced Defensive Stats**

```{r}
url <- getURL("https://raw.githubusercontent.com/jeffreychu48/RSM384/refs/heads/main/2023-2024%20NBA%20Player%20Advanced%20Defensive%20Stats.csv")
nba.2324.player.adv.def <- read.csv(text = url)
colnames(nba.2324.player.adv.def)[1] = "PLAYER"
```

*Creating a Statistical Minimum (Total Minutes \> 1500) and removing Outliers*

```{r}
nba.2324.player.adv.def <- nba.2324.player.adv.def %>%
  mutate(GP = as.numeric(GP), MIN = as.numeric(MIN), DEFRTG = as.numeric(DEFRTG)) %>%
  mutate(TOTALMIN = GP*MIN, TOTALMIN = as.numeric (TOTALMIN)) %>% 
  filter(TOTALMIN > 1500)
```


**Merging the Two Datasets**

```{r}
nba.2324.merged <- nba.2324.player.adv.def %>% merge(nba.combine, by = "PLAYER", all = FALSE)
```

**Remove N/A variables from dataset**

```{r}
nba.2324.merged <- na.omit(nba.2324.merged)
```
